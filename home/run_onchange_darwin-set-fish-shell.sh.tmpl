{{ if eq .chezmoi.os "darwin" -}}
#!/bin/bash

set -e

echo "üêü Setting fish as default shell..."

# Check if fish is installed
if ! command -v fish &> /dev/null; then
    echo "Fish is not installed. Please install fish first."
    exit 1
fi

# Get the path to fish
FISH_PATH=$(which fish)

# Check if fish is already the default shell
if [[ "$SHELL" == "$FISH_PATH" ]]; then
    echo "Fish is already the default shell."
    exit 0
fi

# Add fish to /etc/shells if it's not already there
if ! grep -q "$FISH_PATH" /etc/shells; then
    echo "Adding fish to /etc/shells..."
    echo "$FISH_PATH" | sudo tee -a /etc/shells
fi

# Set fish as the default shell
echo "Setting fish as default shell for user $(whoami)..."
chsh -s "$FISH_PATH"

echo "‚úÖ Fish has been set as the default shell!"
echo "‚ö†Ô∏è  You may need to restart your terminal or log out and back in for the change to take effect."
{{ end -}}
